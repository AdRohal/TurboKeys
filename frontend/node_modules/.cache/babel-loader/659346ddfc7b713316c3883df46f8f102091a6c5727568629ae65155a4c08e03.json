{"ast":null,"code":"// This file handles OAuth token processing when user returns from OAuth provider\nimport React,{useEffect}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../../contexts/AuthContext';import api from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OAuthCallback=()=>{const navigate=useNavigate();const{login}=useAuth();useEffect(()=>{const handleOAuthCallback=async()=>{// Get token from URL parameters\nconst urlParams=new URLSearchParams(window.location.search);const token=urlParams.get('token');if(!token){console.error('No token found in OAuth callback');navigate('/login');return;}try{// Store the token first\nlocalStorage.setItem('token',token);// Get user info with the token\nconst response=await api.get('/auth/me');const user=response.data;// Check if profile completion is needed\nif(!user.profileCompleted){navigate('/complete-profile');}else{// User profile is complete, log them in\nlogin(user);navigate('/');}}catch(error){console.error('OAuth callback error:',error);localStorage.removeItem('token');navigate('/login');}};handleOAuthCallback();},[navigate,login]);return/*#__PURE__*/_jsx(\"div\",{className:\"h-screen flex items-center justify-center bg-white dark:bg-primary-900\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300\",children:\"Processing authentication...\"})]})});};export default OAuthCallback;","map":{"version":3,"names":["React","useEffect","useNavigate","useAuth","api","jsx","_jsx","jsxs","_jsxs","OAuthCallback","navigate","login","handleOAuthCallback","urlParams","URLSearchParams","window","location","search","token","get","console","error","localStorage","setItem","response","user","data","profileCompleted","removeItem","className","children"],"sources":["C:/GitHub/TurboKeys/frontend/src/components/Auth/OAuthCallback.tsx"],"sourcesContent":["// This file handles OAuth token processing when user returns from OAuth provider\r\nimport React, { useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport api from '../../services/api';\r\n\r\nconst OAuthCallback: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { login } = useAuth();\r\n\r\n  useEffect(() => {\r\n    const handleOAuthCallback = async () => {\r\n      // Get token from URL parameters\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      const token = urlParams.get('token');\r\n\r\n      if (!token) {\r\n        console.error('No token found in OAuth callback');\r\n        navigate('/login');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Store the token first\r\n        localStorage.setItem('token', token);\r\n        \r\n        // Get user info with the token\r\n        const response = await api.get('/auth/me');\r\n        const user = response.data;\r\n        \r\n        // Check if profile completion is needed\r\n        if (!user.profileCompleted) {\r\n          navigate('/complete-profile');\r\n        } else {\r\n          // User profile is complete, log them in\r\n          login(user);\r\n          navigate('/');\r\n        }\r\n      } catch (error) {\r\n        console.error('OAuth callback error:', error);\r\n        localStorage.removeItem('token');\r\n        navigate('/login');\r\n      }\r\n    };\r\n\r\n    handleOAuthCallback();\r\n  }, [navigate, login]);\r\n\r\n  return (\r\n    <div className=\"h-screen flex items-center justify-center bg-white dark:bg-primary-900\">\r\n      <div className=\"text-center\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4\"></div>\r\n        <p className=\"text-gray-600 dark:text-gray-300\">Processing authentication...</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OAuthCallback;\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,OAAO,KAAQ,4BAA4B,CACpD,MAAO,CAAAC,GAAG,KAAM,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErC,KAAM,CAAAC,aAAuB,CAAGA,CAAA,GAAM,CACpC,KAAM,CAAAC,QAAQ,CAAGR,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAES,KAAM,CAAC,CAAGR,OAAO,CAAC,CAAC,CAE3BF,SAAS,CAAC,IAAM,CACd,KAAM,CAAAW,mBAAmB,CAAG,KAAAA,CAAA,GAAY,CACtC;AACA,KAAM,CAAAC,SAAS,CAAG,GAAI,CAAAC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAC7D,KAAM,CAAAC,KAAK,CAAGL,SAAS,CAACM,GAAG,CAAC,OAAO,CAAC,CAEpC,GAAI,CAACD,KAAK,CAAE,CACVE,OAAO,CAACC,KAAK,CAAC,kCAAkC,CAAC,CACjDX,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CAEA,GAAI,CACF;AACAY,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEL,KAAK,CAAC,CAEpC;AACA,KAAM,CAAAM,QAAQ,CAAG,KAAM,CAAApB,GAAG,CAACe,GAAG,CAAC,UAAU,CAAC,CAC1C,KAAM,CAAAM,IAAI,CAAGD,QAAQ,CAACE,IAAI,CAE1B;AACA,GAAI,CAACD,IAAI,CAACE,gBAAgB,CAAE,CAC1BjB,QAAQ,CAAC,mBAAmB,CAAC,CAC/B,CAAC,IAAM,CACL;AACAC,KAAK,CAACc,IAAI,CAAC,CACXf,QAAQ,CAAC,GAAG,CAAC,CACf,CACF,CAAE,MAAOW,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7CC,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC,CAChClB,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAAC,CAEDE,mBAAmB,CAAC,CAAC,CACvB,CAAC,CAAE,CAACF,QAAQ,CAAEC,KAAK,CAAC,CAAC,CAErB,mBACEL,IAAA,QAAKuB,SAAS,CAAC,wEAAwE,CAAAC,QAAA,cACrFtB,KAAA,QAAKqB,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BxB,IAAA,QAAKuB,SAAS,CAAC,gFAAgF,CAAM,CAAC,cACtGvB,IAAA,MAAGuB,SAAS,CAAC,kCAAkC,CAAAC,QAAA,CAAC,8BAA4B,CAAG,CAAC,EAC7E,CAAC,CACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAArB,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}